(()=>{"use strict";const t=class{constructor(t,e,n,i,d,o){this.title=t,this.notes=e,this.dateDue=n,this.priority=i,this.projectName=d,this.done=o}changeStatus(){!1===this.done?this.done=!0:this.done=!1}},e=function(t,e,n){let i,d;if(t||e)i=t,d=t;else{i=document.querySelector("#content");const t=document.getElementById("newTaskButton");i.removeChild(t),d=document.createElement("li"),i.appendChild(d)}d.setAttribute("class","addNewItemExpand");const o=document.createElement("input");o.setAttribute("class","main"),o.setAttribute("type","text"),d.appendChild(o);const s=document.createElement("label");s.textContent="Due Date",d.appendChild(s);let c=new Date;c=c.toISOString().slice(0,10);const r=document.createElement("input");r.setAttribute("class","date"),r.setAttribute("type","date"),r.setAttribute("placeholder","Date"),d.appendChild(r);const a=document.createElement("label");a.textContent="Priority",d.appendChild(a);const l=document.createElement("select");l.setAttribute("class","priority"),d.appendChild(l);const u=document.createElement("option");u.setAttribute("value","High"),u.textContent="High",e&&"High"===e.priority&&u.setAttribute("selected","selected"),l.appendChild(u);const p=document.createElement("option");p.setAttribute("value","Medium"),p.textContent="Medium",e&&"Medium"===e.priority&&p.setAttribute("selected","selected"),l.appendChild(p);const m=document.createElement("option");m.setAttribute("value","Low"),m.textContent="Low",e&&"Low"===e.priority&&m.setAttribute("selected","selected"),l.appendChild(m);const L=document.createElement("br");d.appendChild(L);const h=document.createElement("textarea");h.setAttribute("class","notes"),h.setAttribute("rows","4"),h.setAttribute("cols","50"),h.setAttribute("placeholder","Notes"),d.appendChild(h);const v=document.createElement("div");v.setAttribute("class","formButtonContainer"),d.appendChild(v);const E=document.createElement("div");E.setAttribute("class","addButton"),E.textContent="Cancel",v.appendChild(E);const C=document.createElement("div");C.setAttribute("class","addButton"),v.appendChild(C),e?(o.setAttribute("id",`titleInputEdit-${n}`),o.setAttribute("value",`${e.title}`),r.setAttribute("id",`dateDueEdit-${n}`),r.setAttribute("value",`${e.dateDue}`),l.setAttribute("id",`priorityEdit-${n}`),h.setAttribute("id",`notesEdit-${n}`),h.innerHTML=`${e.notes}`,C.setAttribute("id",`editSubmit-${n}`),E.setAttribute("id",`editCancel-${n}`),C.textContent="Update",document.getElementById(`titleInputEdit-${n}`).focus()):(o.setAttribute("id","titleInput"),r.setAttribute("id","dateDue"),r.setAttribute("value",`${c}`),l.setAttribute("id","priority"),h.setAttribute("id","notes"),C.setAttribute("id","submit"),E.setAttribute("id","cancel"),C.textContent="Add",document.getElementById("titleInput").focus())},n=function(t){const e=t.projectsList,n=t.activeProjectIndex,i=document.querySelector(".projectWrapper");i.innerHTML="";for(let t=0;t<e.length;t+=1){const d=document.createElement("div");d.setAttribute("class","projectButton"),d.textContent=e[t].projectTitle,n===t&&d.classList.add("pressed"),i.appendChild(d)}},i=function(t,e,n){const i=t,d=e.dateDue,o=`${d[8]}${d[9]}/${d[5]}${d[6]}/${d[2]}${d[3]}`,s=document.createElement("div");s.classList.add("listLower");const c=document.createElement("div");c.classList.add("dueDate"),c.innerHTML=`<em>Date: </em>${o}`;const r=document.createElement("div");r.classList.add("priority"),r.innerHTML=`<em>Priority: </em>${e.priority}`,s.appendChild(c),s.appendChild(r),i.appendChild(s);const a=document.createElement("div");a.classList.add("listLower");const l=document.createElement("div");l.classList.add("notes"),l.innerHTML=`${e.notes}`,a.appendChild(l),i.appendChild(a);const u=document.createElement("div");u.classList.add("listLower");const p=document.createElement("div");p.classList.add("editButton"),p.id=`edit-${n}`,p.textContent="Edit";const m=document.createElement("div");m.classList.add("deleteButton"),m.id=`del-${n}`,m.textContent="Delete",u.appendChild(p),u.appendChild(m),i.appendChild(u)},d={projectsList:[],activeProjectIndex:0,add(t){this.projectsList.push(t)},delete(t){this.projectsList.splice(t,1)},activeProjectName(){return this.projectsList[this.activeProjectIndex].projectTitle}};class o{constructor(t){this.projectTitle=t,this.itemList=[]}add(t){this.itemList.push(t)}delete(t){this.itemList.splice(t,1)}update(t,e){this.itemList.splice(e,1,t)}markAsDone(t){this.itemList[t].changeStatus()}sortItemsByDate(){this.itemList=this.itemList.sort(((t,e)=>parseInt(t.dateDue.split("-").join(""))>parseInt(e.dateDue.split("-").join(""))?1:-1))}sortItemsByPriority(){this.itemList=this.itemList.sort(((t,e)=>{let n,i;switch(t.priority){case"High":n=3;break;case"Medium":n=2;break;default:n=1}switch(e.priority){case"High":i=3;break;case"Medium":i=2;break;default:i=1}return n<i?1:-1}))}}const s=new o("Default");d.add(s),(()=>{function c(){for(let t=0;t<d.projectsList.length;t+=1){const e=JSON.stringify(d.projectsList[t]);localStorage.setItem(`project-${t}`,e)}}function r(){let t=document.querySelectorAll(".projectButton");t=Array.from(t);for(let e=0;e<t.length;e+=1)t[e].addEventListener("click",(()=>{d.activeProjectIndex=e,a(e),n(d),r(),L(),p()}))}function a(t){const e=document.querySelector(".upperPanel"),i=document.querySelector(".projectLabel");if(0===t)e.innerHTML="",i.textContent="To Do List",e.appendChild(i),o();else{e.innerHTML="",i.textContent=d.projectsList[t].projectTitle,e.appendChild(i),o();const s=document.createElement("div");s.classList.add("projectDeleteButton"),s.textContent="Delete",e.appendChild(s),s.addEventListener("click",(()=>{!function(){const t=d.activeProjectIndex,e=function(t,e){const n=t.projectsList[e].projectTitle,i=document.createElement("div");i.classList.add("modalBackground"),document.body.appendChild(i);const d=document.createElement("div");d.classList.add("modal");const o=document.createElement("div");o.innerHTML=`Are you sure you want to delete ${n}?<br>\n    All tasks in this project will be deleted permanently.`,o.classList.add("textBox"),d.appendChild(o);const s=document.createElement("div");s.classList.add("projectButton"),s.classList.add("modalButtons"),s.classList.add("ok"),s.textContent="OK",o.appendChild(s);const c=document.createElement("div");return c.classList.add("projectButton"),c.classList.add("modalButtons"),c.textContent="Cancel",o.appendChild(c),document.body.appendChild(d),{index:e,modalBackground:i,modal:d,okButton:s,cancelButton:c}}(d,t);e.modalBackground.addEventListener("click",(()=>{document.body.removeChild(e.modal),document.body.removeChild(e.modalBackground)})),e.okButton.addEventListener("click",(()=>{d.delete(t),localStorage.removeItem(`project-${d.activeProjectIndex}`);for(let t=0;t<localStorage.length;t+=1)if(localStorage.getItem(`project-${t}`)&&localStorage.removeItem(`project-${t}`),d.projectsList[t]){const e=JSON.stringify(d.projectsList[t]);localStorage.setItem(`project-${t}`,e)}d.activeProjectIndex=0,a(0),n(d),document.body.removeChild(e.modal),document.body.removeChild(e.modalBackground),r(),L(),p()})),e.cancelButton.addEventListener("click",(()=>{document.body.removeChild(e.modal),document.body.removeChild(e.modalBackground)}))}()}))}function o(){const t=d.activeProjectIndex,n=document.createElement("div");n.classList.add("projectSortButton"),n.textContent="Sort by Date",e.appendChild(n),n.addEventListener("click",(()=>{d.projectsList[t].sortItemsByDate(),c(),L()}));const i=document.createElement("div");i.classList.add("projectSortButton"),i.textContent="Sort by Priority",e.appendChild(i),i.addEventListener("click",(()=>{d.projectsList[t].sortItemsByDate(),d.projectsList[t].sortItemsByPriority(),c(),L()}))}}function l(e,n){let i,o,s,r;const a=d.activeProjectName();let l;if(l=void 0===n?"":`Edit-${n}`,("click"===e.type||"Enter"===e.key)&&(i=document.querySelector(`#titleInput${l}`).value,o=document.querySelector(`#notes${l}`).value,s=document.querySelector(`#dateDue${l}`).value,r=document.querySelector(`#priority${l}`).value,!i))return;const u=new t(i,o,s,r,a,!1),p=d.activeProjectIndex;void 0===n?(d.projectsList[p].add(u),document.querySelector("#titleInput").value=""):d.projectsList[p].update(u,n),c(),L()}function u(t,n,i){t.innerHTML="",e(t,n,i);const d=document.querySelector(`#editSubmit-${i}`),o=document.querySelector(`#editCancel-${i}`),s=document.getElementById(`titleInputEdit-${i}`);d.addEventListener("click",(t=>{l(t,i)})),o.addEventListener("click",(()=>{h()})),s.addEventListener("keypress",(t=>{"Enter"===t.key&&l(t,i)}))}function p(t){if(!t){const t=document.querySelector(".projectWrapper"),e=document.createElement("div");e.id="newProjectButton",e.classList.add("projectNewButton"),e.textContent="Add New Project",e.addEventListener("click",(()=>{t.removeChild(e);const n=function(t){const e=document.createElement("div");e.classList.add("projectNewButtonPressed"),t.appendChild(e);const n=document.createElement("input");n.setAttribute("class","projectInput"),n.setAttribute("type","text"),n.setAttribute("id","newProject"),e.appendChild(n),n.focus();const i=document.createElement("div");return i.setAttribute("class","addButton"),i.setAttribute("id","projectSubmit"),i.textContent="Add",t.appendChild(i),{input:n,buttonAdd:i}}(t);n.input.addEventListener("keypress",(t=>{if("Enter"===t.key){if(!n.input.value)return;m(n.input.value)}})),n.buttonAdd.addEventListener("click",(()=>{n.input.value&&m(n.input.value)}))})),t.appendChild(e)}}function m(t){d.activeProjectIndex=d.projectsList.length;const e=new o(t);d.add(e);const i=JSON.stringify(e);localStorage.setItem(`project-${d.activeProjectIndex}`,i),a(d.activeProjectIndex),n(d),r(),L(),p()}function L(){const t=document.querySelector("#content");t.innerHTML="";const n=d.activeProjectIndex;for(let e=0;e<d.projectsList[n].itemList.length;e+=1){const o=document.createElement("li");o.classList.add("listItem");const s=document.createElement("div");s.classList.add("listUpper"),s.id=`list-${e}`,s.textContent=d.projectsList[n].itemList[e].title,s.addEventListener("click",(t=>{t.path[0]===s&&(d.projectsList[n].markAsDone(e),c(),L())})),o.appendChild(s),!0===d.projectsList[n].itemList[e].done&&s.classList.add("taskDoneText");const r=document.createElement("div");r.classList.add("pressZone");const a=document.createElement("div");a.classList.add("itemTriangle"),r.appendChild(a),s.appendChild(r);const l=document.createElement("div");l.classList.add("listLowerSecton"),o.appendChild(l),r.addEventListener("click",(()=>{if(a.classList.contains("flipped"))a.classList.remove("flipped"),l.innerHTML="";else{a.classList.add("flipped"),i(l,d.projectsList[n].itemList[e],e);const t=o.querySelector(".deleteButton");t.addEventListener("click",(()=>{const e=t.id.split("-");d.projectsList[n].delete(e[1]),c(),L()})),o.querySelector(".editButton").addEventListener("click",(()=>{u(o,d.projectsList[n].itemList[e],e)}))}})),t.appendChild(o)}!function(){const t=document.querySelector("#content"),n=document.createElement("li");n.id="newTaskButton",n.classList.add("addNewItem"),n.textContent="Add new task",t.appendChild(n),n.addEventListener("click",(()=>{e();const t=document.querySelector("#submit"),n=document.querySelector("#cancel"),i=document.querySelector("#titleInput");t.addEventListener("click",(t=>{l(t)})),n.addEventListener("click",(()=>h())),i.addEventListener("keypress",(t=>{"Enter"===t.key&&l(t)}))}))}()}function h(){L()}n(d),r(),L(),p(),a(0),function(){if(0===localStorage.length){const e=new t("Make pancakes","Mix flour, eggs and milk in a bowl.","2021-03-11","Low","Default",!1),n=new t("Heat pan","First thing in the morning","2021-03-10","High","Default",!1),i=new t("Eat pancakes","Remember lemon and sugar.","2021-03-12","Low","Default",!1);s.add(e),s.add(n),s.add(i),c()}else for(let e=0;e<localStorage.length;e+=1){const n=JSON.parse(localStorage.getItem(`project-${e}`));if(0===e);else{const t=new o(n.projectTitle);d.add(t)}for(let i=0;i<n.itemList.length;i+=1){const o=new t(n.itemList[i].title,n.itemList[i].notes,n.itemList[i].dateDue,n.itemList[i].priority,n.itemList[i].projectName,n.itemList[i].done);d.projectsList[e].add(o)}const i=JSON.stringify(d.projectsList[e]);localStorage.setItem(`project-${e}`,i)}n(d),r(),L(),p(),a(0)}()})()})();