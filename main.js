(()=>{"use strict";const e=function(e,t,i){let n,d;if(e||t)n=e,d=e;else{n=document.querySelector("#content");let e=document.getElementById("newTaskButton");n.removeChild(e),d=document.createElement("li"),n.appendChild(d)}d.setAttribute("class","addNewItemExpand");let s=document.createElement("input");s.setAttribute("class","main"),s.setAttribute("type","text"),d.appendChild(s);let c=document.createElement("label");c.textContent="Due Date",d.appendChild(c);let r=new Date;r=r.toISOString().slice(0,10);let l=document.createElement("input");l.setAttribute("class","date"),l.setAttribute("type","date"),l.setAttribute("placeholder","Date"),d.appendChild(l);let o=document.createElement("label");o.textContent="Priority",d.appendChild(o);let a=document.createElement("select");a.setAttribute("class","priority"),d.appendChild(a);let u=document.createElement("option");u.setAttribute("value","High"),u.textContent="High",t&&"High"===t.priority&&u.setAttribute("selected","selected"),a.appendChild(u);let p=document.createElement("option");p.setAttribute("value","Medium"),p.textContent="Medium",t&&"Medium"===t.priority&&p.setAttribute("selected","selected"),a.appendChild(p);let m=document.createElement("option");m.setAttribute("value","Low"),m.textContent="Low",t&&"Low"===t.priority&&m.setAttribute("selected","selected"),a.appendChild(m);let L=document.createElement("br");d.appendChild(L);let h=document.createElement("textarea");h.setAttribute("class","notes"),h.setAttribute("rows","4"),h.setAttribute("cols","50"),h.setAttribute("placeholder","Notes"),d.appendChild(h);let v=document.createElement("div");v.setAttribute("class","formButtonContainer"),d.appendChild(v);let E=document.createElement("div");E.setAttribute("class","addButton"),E.textContent="Cancel",v.appendChild(E);let C=document.createElement("div");C.setAttribute("class","addButton"),v.appendChild(C),t?(s.setAttribute("id",`titleInputEdit-${i}`),s.setAttribute("value",`${t.title}`),l.setAttribute("id",`dateDueEdit-${i}`),l.setAttribute("value",`${t.dateDue}`),a.setAttribute("id",`priorityEdit-${i}`),h.setAttribute("id",`notesEdit-${i}`),h.innerHTML=`${t.notes}`,C.setAttribute("id",`editSubmit-${i}`),E.setAttribute("id",`editCancel-${i}`),C.textContent="Update",document.getElementById(`titleInputEdit-${i}`).focus()):(s.setAttribute("id","titleInput"),l.setAttribute("id","dateDue"),l.setAttribute("value",`${r}`),a.setAttribute("id","priority"),h.setAttribute("id","notes"),C.setAttribute("id","submit"),E.setAttribute("id","cancel"),C.textContent="Add",document.getElementById("titleInput").focus())},t=function(e){const t=e.projectsList,i=e.activeProjectIndex,n=document.querySelector(".projectWrapper");n.innerHTML="";for(let e=0;e<t.length;e++){let d=document.createElement("div");d.setAttribute("class","projectButton"),d.textContent=t[e].projectTitle,i===e&&d.classList.add("pressed"),n.appendChild(d)}},i=function(e,t,i){const n=e,d=t.dateDue,s=`${d[8]}${d[9]}/${d[5]}${d[6]}/${d[2]}${d[3]}`;let c=document.createElement("div");c.classList.add("listLower");let r=document.createElement("div");r.classList.add("dueDate"),r.innerHTML=`<em>Date: </em>${s}`;let l=document.createElement("div");l.classList.add("priority"),l.innerHTML=`<em>Priority: </em>${t.priority}`,c.appendChild(r),c.appendChild(l),n.appendChild(c);let o=document.createElement("div");o.classList.add("listLower");let a=document.createElement("div");a.classList.add("notes"),a.innerHTML=`${t.notes}`,o.appendChild(a),n.appendChild(o);let u=document.createElement("div");u.classList.add("listLower");let p=document.createElement("div");p.classList.add("editButton"),p.id=`edit-${i}`,p.textContent="Edit";let m=document.createElement("div");m.classList.add("deleteButton"),m.id=`del-${i}`,m.textContent="Delete",u.appendChild(p),u.appendChild(m),n.appendChild(u)},n={projectsList:[],activeProjectIndex:0,add:function(e){this.projectsList.push(e)},delete:function(e){this.projectsList.splice(e,1)},activeProjectName:function(){return this.projectsList[this.activeProjectIndex].projectTitle}};class d{constructor(e){this.projectTitle=e,this.itemList=[]}add(e){this.itemList.push(e)}delete(e){this.itemList.splice(e,1)}update(e,t){this.itemList.splice(t,1,e)}markAsDone(e){this.itemList[e].changeStatus()}sortItemsByDate(){this.itemList=this.itemList.sort(((e,t)=>parseInt(e.dateDue.split("-").join(""))>parseInt(t.dateDue.split("-").join(""))?1:-1))}sortItemsByPriority(){this.itemList=this.itemList.sort(((e,t)=>{let i,n;switch(e.priority){case"High":i=3;break;case"Medium":i=2;break;case"Low":i=1}switch(t.priority){case"High":n=3;break;case"Medium":n=2;break;case"Low":n=1}return i<n?1:-1}))}}class s{constructor(e,t,i,n,d){this.title=e,this.notes=t,this.dateDue=i,this.priority=n,this.projectName=d,this.done=!1}changeStatus(){!1===this.done?this.done=!0:this.done=!1}}const c=new d("Default"),r=new d("Music Project"),l=new s("Make pancakes","...","2021-03-11","Low","Default"),o=new s("Heat pan","First thing in the morning","2021-03-10","High","Default"),a=new s("Eat pancakes","...","2021-03-12","Low","Default"),u=new s("Play concert","Before bed.","2021-03-19","High","Music Project"),p=new s("Tune guitar","...","2021-03-15","Medium","Music Project"),m=new s("Practise music","...","2021-03-18","Low","Music Project");n.add(c),n.add(r),c.add(l),c.add(o),c.add(a),r.add(u),r.add(p),r.add(m);const L=function(){function c(){let e=document.querySelectorAll(".projectButton");e=Array.from(e);for(let i=0;i<e.length;i++)e[i].addEventListener("click",(()=>{n.activeProjectIndex=i,r(i),t(n),c(),u(),o()}))}function r(e){let i=document.querySelector(".upperPanel"),d=document.querySelector(".projectLabel");if(0===e)i.innerHTML="",d.textContent="To Do List",i.appendChild(d),s();else{i.innerHTML="",d.textContent=n.projectsList[e].projectTitle,i.appendChild(d),s();let c=document.createElement("div");c.classList.add("projectDeleteButton"),c.textContent="Delete",i.appendChild(c),c.addEventListener("click",(()=>{!function(){let e=n.activeProjectIndex,i=n.projectsList[e].projectTitle,d=document.createElement("div");d.classList.add("modalBackground"),document.body.appendChild(d);let s=document.createElement("div");s.classList.add("modal");let c=document.createElement("div");c.innerHTML=`Are you sure you want to delete ${i}?<br>\n    All tasks in this project will be deleted permanently.`,c.classList.add("textBox"),s.appendChild(c);let r=document.createElement("div");r.classList.add("projectButton"),r.classList.add("modalButtons"),r.classList.add("ok"),r.textContent="OK",c.appendChild(r);let l=document.createElement("div");l.classList.add("projectButton"),l.classList.add("modalButtons"),l.textContent="Cancel",c.appendChild(l),document.body.appendChild(s),d.addEventListener("click",(()=>{document.body.removeChild(s),document.body.removeChild(d)})),r.addEventListener("click",(()=>{n.delete(e),n.activeProjectIndex=0,L.updateProjectListTitle(0),t(n),document.body.removeChild(s),document.body.removeChild(d),L.projectsListListeners(),L.renderTaskList(),L.newProjectButton()})),l.addEventListener("click",(()=>{document.body.removeChild(s),document.body.removeChild(d)}))}()}))}function s(){let e=n.activeProjectIndex,t=document.createElement("div");t.classList.add("projectSortButton"),t.textContent="Sort by Date",i.appendChild(t),t.addEventListener("click",(()=>{n.projectsList[e].sortItemsByDate(),u()}));let d=document.createElement("div");d.classList.add("projectSortButton"),d.textContent="Sort by Priority",i.appendChild(d),d.addEventListener("click",(()=>{n.projectsList[e].sortItemsByDate(),n.projectsList[e].sortItemsByPriority(),u()}))}}function l(e){let t,i,d,c,r=n.activeProjectName();if("click"===e.type||"Enter"===e.key){if(t=document.querySelector("#titleInput").value,i=document.querySelector("#notes").value,d=document.querySelector("#dateDue").value,c=document.querySelector("#priority").value,!t)return}else t=e;let l=new s(t,i,d,c,r),o=n.activeProjectIndex;n.projectsList[o].add(l),document.querySelector("#titleInput").value="",u()}function o(e){if(!e){let e=document.querySelector(".projectWrapper"),t=document.createElement("div");t.id="newProjectButton",t.classList.add("projectNewButton"),t.textContent="Add New Project",t.addEventListener("click",(()=>{e.removeChild(t);let i=function(e){let t=document.createElement("div");t.classList.add("projectNewButtonPressed"),e.appendChild(t);let i=document.createElement("input");i.setAttribute("class","projectInput"),i.setAttribute("type","text"),i.setAttribute("id","newProject"),t.appendChild(i),i.focus();let n=document.createElement("div");return n.setAttribute("class","addButton"),n.setAttribute("id","projectSubmit"),n.textContent="Add",e.appendChild(n),{input:i,buttonAdd:n}}(e);i.input.addEventListener("keypress",(function(e){if("Enter"===e.key){if(!i.input.value)return;a(i.input.value)}})),i.buttonAdd.addEventListener("click",(()=>{i.input.value&&a(i.input.value)}))})),e.appendChild(t)}}function a(e){n.activeProjectIndex=n.projectsList.length;let i=new d(e);n.add(i),r(n.activeProjectIndex),t(n),c(),u(),o()}function u(){let t=document.querySelector("#content");t.innerHTML="";let d=n.activeProjectIndex;for(let e=0;e<n.projectsList[d].itemList.length;e++){let s=document.createElement("li");s.classList.add("listItem");let c=document.createElement("div");c.classList.add("listUpper"),c.id=`list-${e}`,c.textContent=n.projectsList[d].itemList[e].title,c.addEventListener("click",(t=>{t.path[0]===c&&(n.projectsList[d].markAsDone(e),u())})),s.appendChild(c),!0===n.projectsList[d].itemList[e].done&&c.classList.add("taskDoneText");let r=document.createElement("div");r.classList.add("pressZone");let l=document.createElement("div");l.classList.add("itemTriangle"),r.appendChild(l),c.appendChild(r);let o=document.createElement("div");o.classList.add("listLowerSecton"),s.appendChild(o),r.addEventListener("click",(()=>{if(l.classList.contains("flipped"))l.classList.remove("flipped"),o.innerHTML="";else{l.classList.add("flipped"),i(o,n.projectsList[d].itemList[e],e);let t=s.querySelector(".deleteButton");t.addEventListener("click",(()=>{let e=t.id.split("-");n.projectsList[d].delete(e[1]),u()}));let c=s.querySelector(".editButton");c.addEventListener("click",(()=>{c.id.split("-"),h(s,n.projectsList[d].itemList[e],e)}))}})),t.appendChild(s)}!function(){let t=document.querySelector("#content"),i=document.createElement("li");i.id="newTaskButton",i.classList.add("addNewItem"),i.textContent="Add new task",t.appendChild(i),i.addEventListener("click",(()=>{e(),submit.addEventListener("click",l),cancel.addEventListener("click",(()=>E())),titleInput.addEventListener("keypress",(function(e){"Enter"===e.key&&l(e)}))}))}()}return t(n),c(),u(),o(),r(0),{addToList:l,renderTaskList:u,projectsListListeners:c,updateProjectListTitle:r,renderProjectsList:t,newProjectButton:o}}();function h(t,i,n){t.innerHTML="",e(t,i,n);let d=document.querySelector(`#editSubmit-${n}`),s=document.querySelector(`#editCancel-${n}`),c=document.getElementById(`titleInputEdit-${n}`);d.addEventListener("click",(e=>{v(e,n)})),s.addEventListener("click",(()=>{E()})),c.addEventListener("keypress",(function(e){"Enter"===e.key&&v(e,n)}))}function v(e,t){let i,d,c,r,l=n.activeProjectName();if(("click"===e.type||"Enter"===e.key)&&(i=document.querySelector(`#titleInputEdit-${t}`).value,d=document.querySelector(`#notesEdit-${t}`).value,c=document.querySelector(`#dateDueEdit-${t}`).value,r=document.querySelector(`#priorityEdit-${t}`).value,!i))return;let o=new s(i,d,c,r,l),a=n.activeProjectIndex;n.projectsList[a].update(o,t),L.renderTaskList()}function E(e){L.renderTaskList(n)}})();